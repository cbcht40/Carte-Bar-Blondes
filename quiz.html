<script>
/* --- Questions --- */
const quizData = [
  {
    question: "ğŸ¨ Quelle couleur de biÃ¨re tâ€™attire le plus ?",
    options: [
      { text: "ğŸ¯ Blonde", value: "blonde" },
      { text: "ğŸ« Brune", value: "brune" },
      { text: "ğŸŒ¾ Blanche", value: "blanche" },
      { text: "ğŸ’ Rouge", value: "rouge" },
      { text: "â˜• Stout", value: "stout" },
      { text: "ğŸ‹ Sour", value: "sour" },
      { text: "ğŸ Cidre", value: "cidre" }
    ]
  },
  {
    question: "ğŸ‰ Quel est ton mood ce soir ?",
    options: [
      { text: "ğŸ˜Œ DÃ©tente tranquille", value: "detente" },
      { text: "ğŸ» SoirÃ©e entre amis", value: "amis" },
      { text: "ğŸ’ƒ FÃªte et ambiance", value: "fete" },
      { text: "ğŸ½ï¸ Repas gourmand", value: "repas" },
      { text: "ğŸ§­ DÃ©couverte et curiositÃ©", value: "decouverte" }
    ]
  },
  {
    question: "ğŸ¯ Quel goÃ»t te tente le plus ?",
    options: [
      { text: "ğŸŒ¼ Doux et facile Ã  boire", value: "doux" },
      { text: "ğŸ‹ FruitÃ© et frais", value: "fruite" },
      { text: "ğŸŒ¿ Amer et houblonnÃ©", value: "amer" },
      { text: "ğŸ MaltÃ© et rond", value: "malte" },
      { text: "ğŸ AcidulÃ© et surprenant", value: "acidule" },
      { text: "ğŸ”¥ BoisÃ© ou Ã©picÃ©", value: "boise" }
    ]
  },
  {
    question: "ğŸ’ª Tu veux une biÃ¨reâ€¦",
    options: [
      { text: "ğŸƒ LÃ©gÃ¨re", value: "legere" },
      { text: "âš–ï¸ Moyenne", value: "moyenne" },
      { text: "ğŸ”¥ Bien corsÃ©e", value: "forte" }
    ]
  },
  {
    question: "ğŸ’« Si ta biÃ¨re avait une personnalitÃ© ?",
    options: [
      { text: "ğŸ© Ã‰lÃ©gante et raffinÃ©e", value: "elegante" },
      { text: "ğŸ‰ Joyeuse et conviviale", value: "joyeuse" },
      { text: "ğŸ§” Sage et posÃ©e", value: "sage" },
      { text: "ğŸ¨ Originale et crÃ©ative", value: "originale" },
      { text: "âš¡ Audacieuse et intense", value: "intense" }
    ]
  }
];

/* --- Base de donnÃ©es biÃ¨res corrigÃ©e et sans ambrÃ©e --- */
const beers = [
  { name: "Fouillotte Blonde", tags: ["blonde", "doux", "legere", "detente", "decouverte"] },
  { name: "Blanche Bernardus", tags: ["blanche", "fruite", "moyenne", "detente", "douce"] },
  { name: "Weihenstephaner Vitus", tags: ["blanche", "fruite", "moyenne", "repas", "elegante"] },
  { name: "Trappe Blonde", tags: ["blonde", "malte", "moyenne", "amis", "equilibree"] },
  { name: "Ypra Lefort", tags: ["blonde", "malte", "forte", "repas", "fete"] },
  { name: "Timut", tags: ["blonde", "acidule", "legere", "apero", "originale"] },
  { name: "Delta IPA", tags: ["blonde", "amer", "moyenne", "fete", "originale"] },
  { name: "Milkshake IPA", tags: ["blonde", "fruite", "moyenne", "fete", "creative"] },
  { name: "Whisky Infused", tags: ["brune", "malte", "forte", "decouverte", "intense"] },
  { name: "Prior Bernardus", tags: ["brune", "malte", "forte", "repas", "sage"] },
  { name: "Blackheart", tags: ["stout", "malte", "legere", "detente", "discrete"] },
  { name: "Rouge Max", tags: ["rouge", "fruite", "forte", "fete", "joyeuse"] },
  { name: "Kriek", tags: ["rouge", "fruite", "legere", "detente", "joyeuse"] },
  { name: "Noble Coz Cidre", tags: ["cidre", "acidule", "forte", "apero", "originale"] },
  { name: "Brunehaut", tags: ["blonde", "malte", "moyenne", "repas", "elegante"] },
  { name: "St Idesbald Blonde", tags: ["blonde", "malte", "moyenne", "repas", "elegante"] },
  { name: "Tarot", tags: ["blonde", "fruite", "forte", "fete", "creative"] },
  { name: "Shorba", tags: ["sour", "acidule", "moyenne", "apero", "originale"] },
  { name: "NEIPA", tags: ["blonde", "fruite", "moyenne", "fete", "creative"] },
  { name: "Pils Estaminet", tags: ["blonde", "doux", "legere", "detente", "classique"] },
  { name: "Triple Bernardus", tags: ["blonde", "malte", "forte", "repas", "elegante"] }
];

let current = 0;
let answers = [];

const quizEl = document.getElementById("quiz");
const progressEl = document.getElementById("progress");

function showQuestion() {
  const q = quizData[current];
  quizEl.innerHTML = `
    <div class="question">${q.question}</div>
    ${q.options.map(o => `<button class="option" onclick="choose('${o.value}')">${o.text}</button>`).join('')}
  `;
  progressEl.style.width = `${(current / quizData.length) * 100}%`;
}

function choose(value) {
  answers.push(value);
  current++;
  if (current < quizData.length) showQuestion();
  else showResult();
}

function showResult() {
  progressEl.style.width = "100%";
  const colorChoice = answers[0];
  const scores = beers.map(b => ({
    name: b.name,
    color: b.tags[0],
    score: answers.reduce((s, a) => s + (b.tags.includes(a) ? 1 : 0), 0)
  }));

  let best = scores.sort((a, b) => b.score - a.score)[0];
  let beer = beers.find(b => b.name === best.name);

  // Si la couleur ne correspond pas, chercher une alternative de mÃªme couleur
  if (beer.tags[0] !== colorChoice) {
    const sameColor = scores.filter(s => s.color === colorChoice);
    if (sameColor.length > 0) {
      best = sameColor.sort((a, b) => b.score - a.score)[0];
      beer = beers.find(b => b.name === best.name);
      quizEl.innerHTML = `
        <div class="result">
          <h2>ğŸº ${beer.name}</h2>
          <p>Aucune ${colorChoice} ne correspond parfaitement Ã  ton profilâ€¦<br>
          Mais voici une ${colorChoice} qui devrait te plaire ğŸ‘‡</p>
          <button class="btn" onclick="window.location.href='carte.html#${beer.name.replaceAll(' ', '-').toLowerCase()}'">DÃ©couvrir sur la carte</button>
          <button class="btn" onclick="window.location.href='carte.html'">Voir tout le menu</button>
        </div>`;
      return;
    }
  }

  // Sinon, biÃ¨re parfaite
  quizEl.innerHTML = `
    <div class="result">
      <h2>ğŸº ${beer.name}</h2>
      <p>VoilÃ  la biÃ¨re qui te correspond le mieux ! DÃ©couvre-la dans notre carte ğŸ»</p>
      <button class="btn" onclick="window.location.href='carte.html#${beer.name.replaceAll(' ', '-').toLowerCase()}'">DÃ©couvrir sur la carte</button>
      <button class="btn" onclick="window.location.href='carte.html'">Voir tout le menu</button>
    </div>`;
}

showQuestion();
</script>
