<script>
document.addEventListener("DOMContentLoaded", () => {
  const questions = [
    { text: "Quelle couleur de biÃ¨re prÃ©fÃ¨res-tu ?", options: [
      { text: "Blanche", value: "blanche" },
      { text: "Blonde", value: "blonde" },
      { text: "AmbrÃ©e / Brune", value: "ambrÃ©e" },
      { text: "Rouge", value: "rouge" }
    ]},
    { text: "Tu veux une biÃ¨re plutÃ´tâ€¦", options: [
      { text: "Douce et facile Ã  boire", value: "douce" },
      { text: "AmÃ¨re et expressive", value: "amere" },
      { text: "FruitÃ©e et originale", value: "fruitee" },
      { text: "Puissante et maltÃ©e", value: "forte" }
    ]},
    { text: "Et ton humeur du moment ?", options: [
      { text: "Je veux me rafraÃ®chir ğŸ‹", value: "legere" },
      { text: "Je veux dÃ©couvrir ğŸŒ¿", value: "originale" },
      { text: "Je veux faire la fÃªte ğŸ”¥", value: "forte" },
      { text: "Je veux me dÃ©tendre ğŸ‚", value: "ronde" }
    ]}
  ];

  const beers = {
    blanche: {name:"Blanche Bernardus (6Â°, Belgique)", desc:"Blanche belge douce et Ã©picÃ©e, aux notes dâ€™agrumes et de coriandre."},
    vitus: {name:"Weihenstephaner Vitus (7.7Â°, Allemagne)", desc:"Weizenbock riche et fruitÃ©e, banane et clou de girofle."},
    fouillotte: {name:"Fouillotte Blonde (4Â°, France)", desc:"Blonde artisanale brassÃ©e avec des branches de sapin ğŸŒ², au petit goÃ»t rÃ©sineux et boisÃ©."},
    trappe: {name:"Trappe Blonde (6.5Â°, Pays-Bas)", desc:"Blonde trappiste florale et Ã©quilibrÃ©e, lÃ©gÃ¨rement sucrÃ©e et ronde."},
    timut: {name:"Timut (4Â°, France)", desc:"Blonde lÃ©gÃ¨re et citronnÃ©e au poivre de Timut, exotique et rafraÃ®chissante."},
    ypra: {name:"Ypra Lefort (10Â°, Belgique)", desc:"Triple belge dorÃ©e, complexe et fruitÃ©e, aux notes caramÃ©lisÃ©es."},
    prior: {name:"Prior Bernardus (8Â°, Belgique)", desc:"Double belge maltÃ©e et ronde, arÃ´mes de fruits secs et caramel."},
    whisky: {name:"Whisky Infused (12.7Â°, France)", desc:"AmbrÃ©e infusÃ©e au whisky, intense, boisÃ©e et vanillÃ©e."},
    rouge: {name:"Rouge Max (8Â°, Belgique)", desc:"Rouge douce et fruitÃ©e, saveurs de cerise mÃ»re et fruits rouges."},
    kriek: {name:"Kriek (5.5Â°, Belgique)", desc:"Rouge Ã  la cerise, acidulÃ©e et sucrÃ©e, typiquement belge."}
  };

  const phrases = {
    incoherent: [
      "Ah, Ã§a câ€™est rare chez nous ğŸ˜„ On est un gros bar Ã  biÃ¨res, mais ce style-lÃ  on ne le fait pas vraiment.",
      "Pas commun Ã§a ğŸ˜… Chez nous, on reste sur des classiques bien faits, pas de mÃ©lange improbable !",
      "Ouh, pas sÃ»r que Ã§a existe vraiment ğŸ˜† Mais jâ€™ai mieux Ã  te proposerâ€¦",
      "Hmm, mÃªme avec nos 24 pressions, celle-lÃ  on ne lâ€™a pas encore inventÃ©e ğŸ»"
    ]
  };

  let step = 0;
  const answers = [];
  const quiz = document.getElementById("quiz");

  function renderQuestion() {
    const q = questions[step];
    quiz.innerHTML = `
      <div class="progress">Question ${step+1} / ${questions.length}</div>
      <div class="question">${q.text}</div>
      <div class="options">
        ${q.options.map(o => `<button onclick="select('${o.value}')">${o.text}</button>`).join('')}
      </div>`;
  }

  window.select = function(v) {
    answers.push(v);
    step++;
    if (step < questions.length) renderQuestion();
    else showResult();
  }

  function showResult() {
    const combo = answers.join('-');
    let beer, note = "";

    if (combo.includes("blanche")) {
      if (combo.includes("forte")) { note = phrases.incoherent[1]; beer = beers.vitus; }
      else beer = beers.blanche;
    } else if (combo.includes("blonde")) {
      if (combo.includes("forte")) beer = beers.ypra;
      else if (combo.includes("legere")) beer = beers.fouillotte;
      else if (combo.includes("fruitee") || combo.includes("originale")) beer = beers.timut;
      else beer = beers.trappe;
    } else if (combo.includes("ambrÃ©e")) {
      if (combo.includes("forte")) beer = beers.whisky;
      else beer = beers.prior;
    } else if (combo.includes("rouge")) {
      if (combo.includes("douce")) beer = beers.rouge;
      else beer = beers.kriek;
    } else {
      note = phrases.incoherent[3];
      beer = beers.trappe;
    }

    quiz.innerHTML = `
      <h2 class="beer-result">${beer.name}</h2>
      ${note ? `<div class="note">${note}</div>` : ""}
      <div class="options">
        <button onclick="toggleDesc()">ğŸ“– DÃ©tails de la biÃ¨re</button>
        <button onclick="location.href='carte.html#menu'">ğŸ“œ Voir sur la carte</button>
        <button onclick="restartQuiz()">ğŸ”„ Refaire le quiz</button>
      </div>
      <div class="desc" id="desc">${beer.desc}</div>
    `;
  }

  window.toggleDesc = function() {
    const desc = document.getElementById("desc");
    desc.style.display = desc.style.display === "block" ? "none" : "block";
  }

  window.restartQuiz = function() {
    step = 0;
    answers.length = 0;
    renderQuestion();
  }

  renderQuestion();
});
</script>
